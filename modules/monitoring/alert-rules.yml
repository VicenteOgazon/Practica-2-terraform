groups:
  - name: web.rules
    rules:
      - alert: WebInstanceDownProd
        expr: up{job="web_app", instance=~"prod_web-.*"} == 0
        for: 5s
        labels:
          severity: warning
        annotations:
          summary: "Instancia web de PRODUCCIÓN caída ({{ $labels.instance }})"
          description: "La instancia {{ $labels.instance }} lleva caída más de 5 segundos."

  - name: db.rules
    rules:
      - alert: DBContainerDownProd
        expr: time() - container_last_seen{job="cadvisor", id="/system.slice/docker-c06072283e06e45ae923c60b79e3b71c21c2cbf0a5e2030ce2bdb42a74d4c720.scope"} > 30
        for: 0s
        labels:
          severity: critical
        annotations:
          summary: "Contenedor de base de datos de PRODUCCIÓN caído"
          description: "No se han recibido métricas del contenedor DB de producción en los últimos 5s."

  - name: lb.rules
    rules:
      - alert: LBContainerDownProd
        expr: time() - container_last_seen{job="cadvisor", id="/system.slice/docker-369d0906a41fdd7ca15bac07c6932b0a933a9c759c6ac2ed4ef74051cc54f4d5.scope"} > 30
        for: 0s
        labels:
          severity: critical
        annotations:
          summary: "Contenedor de load balancer de PRODUCCIÓN caído"
          description: "No se han recibido métricas del contenedor LB de producción en los últimos 5s."